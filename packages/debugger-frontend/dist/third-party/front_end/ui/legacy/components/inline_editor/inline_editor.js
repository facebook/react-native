import*as e from"../../legacy.js";import*as t from"../../../../third_party/codemirror.next/codemirror.next.js";import*as i from"../../../../core/platform/platform.js";import*as n from"../../../visual_logging/visual_logging.js";import*as s from"../../../../core/common/common.js";import*as o from"../../../lit/lit.js";import{render as r,html as a}from"../../../lit/lit.js";import*as l from"../../../../core/i18n/i18n.js";import*as d from"../color_picker/color_picker.js";import*as h from"../../../../core/sdk/sdk.js";import*as c from"../../../components/icon_button/icon_button.js";import*as u from"../../../../panels/css_overview/css_overview.js";import*as p from"../../../components/buttons/buttons.js";const m=t.css.cssLanguage.parser,g=new Intl.NumberFormat("en",{maximumFractionDigits:2});function v(e,t){for(let i=t;i<e.length;i++)if(!isNaN(e[i].input))return i;return-1}function x(e,t){const i=[];for(;","!==e.type.name&&")"!==e.type.name;){const n=t.substring(e.from,e.to);if("NumberLiteral"!==e.type.name)return null;i.push(n),e.next(!1)}if(i.length>3)return null;const n=i.filter((e=>e.includes("%")));if(n.length>2)return null;const s=i.filter((e=>!e.includes("%")));return 1!==s.length?null:{number:Number(s[0]),lengthA:n[0]?Number(n[0].substring(0,n[0].length-1)):void 0,lengthB:n[1]?Number(n[1].substring(0,n[1].length-1)):void 0}}const b={linear:"linear(0 0%, 1 100%)"};class f{#e;constructor(e){this.#e=e}static parse(e){if(b[e])return f.parse(b[e]);const t=function(e){const t=`*{--a: ${e}}`,i=m.parse(t).cursorAt(t.indexOf(":")+1);for(;"ArgList"!==i.name&&i.next(!0);)if("Callee"===i.name&&"linear"!==t.substring(i.from,i.to))return null;if("ArgList"!==i.name)return null;i.firstChild();const n=[];for(;")"!==i.type.name&&i.next(!1);){const e=x(i,t);if(!e)return null;n.push(e)}return n}(e);if(!t||t.length<2)return null;let i=-1/0;const n=[];for(let e=0;e<t.length;e++){const s=t[e],o={input:NaN,output:s.number};if(n.push(o),void 0!==s.lengthA){if(o.input=Math.max(s.lengthA,i),i=o.input,void 0!==s.lengthB){const e={input:NaN,output:o.output};n.push(e),e.input=Math.max(s.lengthB,i),i=e.input}}else 0===e?(o.input=0,i=0):e===t.length-1&&(o.input=Math.max(100,i))}let s=0;for(let e=1;e<n.length;e++)isNaN(n[e].input)&&(e>s&&(s=v(n,e)),n[e].input=n[e-1].input+(n[s].input-n[e-1].input)/(s-(e-1)));return new f(n)}addPoint(e,t){void 0===t?this.#e.push(e):this.#e.splice(t,0,e)}removePoint(e){this.#e.splice(e,1)}setPoint(e,t){this.#e[e]=t}points(){return this.#e}asCSSText(){const e=`linear(${this.#e.map((e=>`${g.format(e.output)} ${g.format(e.input)}%`)).join(", ")})`;for(const[t,i]of Object.entries(b))if(i===e)return t;return e}}var w=Object.freeze({__proto__:null,CSSLinearEasingModel:f});class y{static parse(t){const i=f.parse(t);return i||(e.Geometry.CubicBezier.parse(t)||null)}}const S=e.Geometry.LINEAR_BEZIER;var C=Object.freeze({__proto__:null,AnimationTimingModel:y,LINEAR_BEZIER:S});class I{width;height;marginTop;radius;shouldDrawLine;constructor({width:e,height:t,marginTop:i,controlPointRadius:n,shouldDrawLine:s}){this.width=e,this.height=t,this.marginTop=i,this.radius=n,this.shouldDrawLine=s}static drawVelocityChart(e,t,i){const n=k;let s=["M",0,n];const o=1/40;let r=e.evaluateAt(0);for(let t=o;t<1.025;t+=o){const o=e.evaluateAt(t);let a=(o.y-r.y)/(o.x-r.x);const l=r.x*(1-t)+o.x*t;a=Math.tanh(a/1.5),s=s.concat(["L",(l*i).toFixed(2),(n-a*n).toFixed(2)]),r=o}s=s.concat(["L",i.toFixed(2),n,"Z"]),t.setAttribute("d",s.join(" "))}curveWidth(){return this.width-2*this.radius}curveHeight(){return this.height-2*this.radius-2*this.marginTop}drawLine(t,i,n,s,o,r){const a=e.UIUtils.createSVGChild(t,"line",i);a.setAttribute("x1",String(n+this.radius)),a.setAttribute("y1",String(s+this.radius+this.marginTop)),a.setAttribute("x2",String(o+this.radius)),a.setAttribute("y2",String(r+this.radius+this.marginTop))}drawControlPoints(t,i,s,o,r){this.drawLine(t,"bezier-control-line",i,s,o,r);const a=e.UIUtils.createSVGChild(t,"circle","bezier-control-circle");a.setAttribute("jslog",`${n.controlPoint("bezier.control-circle").track({drag:!0})}`),a.setAttribute("cx",String(o+this.radius)),a.setAttribute("cy",String(r+this.radius+this.marginTop)),a.setAttribute("r",String(this.radius))}drawCurve(t,i){if(!t)return;const n=this.curveWidth(),s=this.curveHeight();i.setAttribute("width",String(this.width)),i.setAttribute("height",String(this.height)),i.removeChildren();const o=e.UIUtils.createSVGChild(i,"g");this.shouldDrawLine&&this.drawLine(o,"linear-line",0,s,n,0);const r=e.UIUtils.createSVGChild(o,"path","bezier-path"),a=[new e.Geometry.Point(t.controlPoints[0].x*n+this.radius,(1-t.controlPoints[0].y)*s+this.radius+this.marginTop),new e.Geometry.Point(t.controlPoints[1].x*n+this.radius,(1-t.controlPoints[1].y)*s+this.radius+this.marginTop),new e.Geometry.Point(n+this.radius,this.marginTop+this.radius)];r.setAttribute("d","M"+this.radius+","+(s+this.radius+this.marginTop)+" C"+a.join(" ")),this.drawControlPoints(o,0,s,t.controlPoints[0].x*n,(1-t.controlPoints[0].y)*s),this.drawControlPoints(o,n,0,t.controlPoints[1].x*n,(1-t.controlPoints[1].y)*s)}}const k=26;var E=Object.freeze({__proto__:null,BezierUI:I,Height:k});class P{#t;#i;#n;#s;#o;#r;#a;constructor({bezier:t,container:i,onBezierChange:n}){this.#i=t,this.#t=new I({width:150,height:250,marginTop:50,controlPointRadius:7,shouldDrawLine:!0}),this.#n=e.UIUtils.createSVGChild(i,"svg","bezier-curve"),this.#a=n,e.UIUtils.installDragHandle(this.#n,this.dragStart.bind(this),this.dragMove.bind(this),this.dragEnd.bind(this),"default")}dragStart(t){this.#s=new e.Geometry.Point(t.x,t.y);const n=this.#t;this.#o=new e.Geometry.Point(i.NumberUtilities.clamp((t.offsetX-n.radius)/n.curveWidth(),0,1),(n.curveHeight()+n.marginTop+n.radius-t.offsetY)/n.curveHeight());const s=this.#o.distanceTo(this.#i.controlPoints[0])<this.#o.distanceTo(this.#i.controlPoints[1]);return this.#r=s?0:1,this.#i.controlPoints[this.#r]=this.#o,this.#a(this.#i),t.consume(!0),!0}updateControlPosition(t,n){if(void 0===this.#s||void 0===this.#o||void 0===this.#r)return;const s=(t-this.#s.x)/this.#t.curveWidth(),o=(n-this.#s.y)/this.#t.curveHeight(),r=new e.Geometry.Point(i.NumberUtilities.clamp(this.#o.x+s,0,1),this.#o.y-o);this.#i.controlPoints[this.#r]=r}dragMove(e){this.updateControlPosition(e.x,e.y),this.#a(this.#i)}dragEnd(e){this.updateControlPosition(e.x,e.y),this.#a(this.#i)}setBezier(e){this.#i=e,this.draw()}draw(){this.#t.drawCurve(this.#i,this.#n)}}class T{params;renderedPositions;constructor(e){this.params=e}#l(){return this.params.width-2*this.params.pointRadius}#d(){return this.params.height-2*this.params.pointRadius-2*this.params.marginTop}#h(t,i,s,o){const r=e.UIUtils.createSVGChild(t,"circle","bezier-control-circle");r.setAttribute("jslog",`${n.controlPoint("bezier.linear-control-circle").track({drag:!0,dblclick:!0})}`),r.setAttribute("data-point-index",String(o)),r.setAttribute("cx",String(i)),r.setAttribute("cy",String(s)),r.setAttribute("r",String(this.params.pointRadius))}timingPointToPosition(e){return{x:e.input/100*this.#l()+this.params.pointRadius,y:(1-e.output)*this.#d()+this.params.pointRadius}}positionToTimingPoint(e){return{input:(e.x-this.params.pointRadius)/this.#l()*100,output:1-(e.y-this.params.pointRadius)/this.#d()}}draw(t,i){i.setAttribute("width",String(this.#l())),i.setAttribute("height",String(this.#d())),i.removeChildren();const n=e.UIUtils.createSVGChild(i,"g"),s=t.points().map((e=>this.timingPointToPosition(e)));this.renderedPositions=s;let o=s[0];for(let t=1;t<s.length;t++){const i=s[t],r=e.UIUtils.createSVGChild(n,"path","bezier-path linear-path");r.setAttribute("d",`M ${o.x} ${o.y} L ${i.x} ${i.y}`),r.setAttribute("data-line-index",String(t)),o=i}for(let e=0;e<s.length;e++){const t=s[e];this.#h(n,t.x,t.y,e)}}}class z{#c;#u;#p;#m;#g;#v;#s;#x;constructor({model:t,container:i,onChange:n}){this.#c=t,this.#u=n,this.#p=new T({width:150,height:250,pointRadius:7,marginTop:50}),this.#x=e.UIUtils.createSVGChild(i,"svg","bezier-curve linear"),e.UIUtils.installDragHandle(this.#x,this.#b.bind(this),this.#f.bind(this),this.#w.bind(this),"default")}#y(e,t){const i=this.#p.positionToTimingPoint({x:e.offsetX,y:e.offsetY});this.#c.addPoint(i,t),this.#m=void 0,this.#s=void 0}#S(e,t){if(this.#m=t,this.#s={x:e.x,y:e.y},clearTimeout(this.#g),this.#v===this.#m)return this.#c.removePoint(this.#m),this.#v=void 0,this.#m=void 0,void(this.#s=void 0);this.#v=this.#m,this.#g=window.setTimeout((()=>{this.#v=void 0}),500)}#b(e){return e.target instanceof SVGElement&&(void 0!==e.target.dataset.lineIndex?(this.#y(e,Number(e.target.dataset.lineIndex)),e.consume(!0),!0):void 0!==e.target.dataset.pointIndex&&(this.#S(e,Number(e.target.dataset.pointIndex)),e.consume(!0),!0))}#C(e,t){if(void 0===this.#m||void 0===this.#s)return;const i=this.#p.renderedPositions?.[this.#m];if(!i)return;const n=e-this.#s.x,s=t-this.#s.y;this.#s={x:e,y:t};const o={x:i.x+n,y:i.y+s};this.#c.setPoint(this.#m,this.#p.positionToTimingPoint(o))}#f(e){this.#C(e.x,e.y),this.#u(this.#c)}#w(e){this.#C(e.x,e.y),this.#u(this.#c)}setCSSLinearEasingModel(e){this.#c=e,this.draw()}draw(){this.#p.draw(this.#c,this.#x)}}class M{#I;#k;constructor(){this.#I=new T({width:40,height:40,marginTop:0,pointRadius:2}),this.#k=new I({width:40,height:40,marginTop:0,controlPointRadius:2,shouldDrawLine:!1})}draw(t,i){t instanceof f?this.#I.draw(t,i):t instanceof e.Geometry.CubicBezier&&this.#k.drawCurve(t,i)}}class A{#E;#P;#T;#c;#u;#z;#M;constructor({model:t,onChange:i}){this.#E=document.createElement("div"),this.#E.className="animation-timing-ui",this.#E.style.width="150px",this.#E.style.height="250px",this.#P=document.createElement("div"),this.#P.classList.add("bezier-ui-container"),this.#T=document.createElement("div"),this.#T.classList.add("linear-easing-ui-container"),this.#E.appendChild(this.#P),this.#E.appendChild(this.#T),this.#c=t,this.#u=i,this.#c instanceof e.Geometry.CubicBezier?this.#z=new P({bezier:this.#c,container:this.#P,onBezierChange:this.#u}):this.#c instanceof f&&(this.#M=new z({model:this.#c,container:this.#T,onChange:this.#u}))}element(){return this.#E}setModel(t){this.#c=t,this.#c instanceof e.Geometry.CubicBezier?this.#z?this.#z.setBezier(this.#c):this.#z=new P({bezier:this.#c,container:this.#P,onBezierChange:this.#u}):this.#c instanceof f&&(this.#M?this.#M.setCSSLinearEasingModel(this.#c):this.#M=new z({model:this.#c,container:this.#T,onChange:this.#u})),this.draw()}draw(){this.#T.classList.toggle("hidden",!(this.#c instanceof f)),this.#P.classList.toggle("hidden",!(this.#c instanceof e.Geometry.CubicBezier)),this.#z&&this.#z.draw(),this.#M&&this.#M.draw()}}var U=Object.freeze({__proto__:null,AnimationTimingUI:A,PresetUI:M}),L={cssText:`:host{width:270px;height:350px;user-select:none;padding:16px;overflow:hidden}.bezier-preset-selected > svg{background-color:var(--sys-color-tonal-container)}.bezier-container{--override-bezier-control-color:var(--sys-color-purple-bright);display:flex;margin-top:38px;flex-shrink:0;z-index:2;background-image:radial-gradient(circle,var(--sys-color-surface-variant) 1px,var(--color-background-inverted-opacity-0) 1px);background-size:17px 17px;background-position:-5px -10px}.bezier-preset{width:50px;height:50px;padding:5px;margin:auto;background-color:var(--sys-color-surface1);border-radius:3px}.bezier-preset line.bezier-control-line{stroke:var(--sys-color-token-subtle);stroke-width:1;stroke-linecap:round;fill:none}.bezier-preset circle.bezier-control-circle{fill:var(--sys-color-token-subtle)}.bezier-preset path.bezier-path{stroke:var(--sys-color-inverse-surface);stroke-width:2;stroke-linecap:round;fill:none}.bezier-preset-selected path.bezier-path,\n.bezier-preset-selected line.bezier-control-line{stroke:var(--sys-color-on-tonal-container)}.bezier-preset-selected circle.bezier-control-circle{fill:var(--sys-color-on-tonal-container)}.bezier-curve line.linear-line{stroke:var(--sys-color-neutral-outline);stroke-width:2;stroke-linecap:round;fill:none}.bezier-curve line.bezier-control-line{stroke:var(--override-bezier-control-color);stroke-width:2;stroke-linecap:round;fill:none;opacity:60%}.bezier-curve circle.bezier-control-circle{fill:var(--override-bezier-control-color);cursor:pointer}.bezier-curve path.bezier-path{stroke:var(--sys-color-inverse-surface);stroke-width:3;stroke-linecap:round;fill:none}.bezier-curve path.bezier-path.linear-path{cursor:pointer}.bezier-preview-container{position:relative;background-color:var(--sys-color-cdt-base-container);overflow:hidden;border-radius:20px;width:200%;height:20px;z-index:2;flex-shrink:0;opacity:0%}.bezier-preview-animation{background-color:var(--sys-color-purple-bright);width:20px;height:20px;border-radius:20px;position:absolute}.bezier-preview-onion{margin-top:-20px;position:relative;z-index:1}.bezier-preview-onion > .bezier-preview-animation{opacity:10%}svg.bezier-preset-modify{background-color:var(--sys-color-cdt-base-container);border-radius:35px;display:inline-block;visibility:hidden;transition:transform 100ms cubic-bezier(0.4,0,0.2,1);cursor:pointer;position:absolute}svg.bezier-preset-modify:hover,\n.bezier-preset:hover{background-color:var(--sys-color-state-hover-on-subtle)}.bezier-preset-selected .bezier-preset:hover{background-color:var(--sys-color-tonal-container)}.bezier-preset-modify path{stroke-width:2;stroke:var(--sys-color-on-surface-subtle);fill:none}.bezier-presets{display:flex;flex-direction:column;justify-content:space-between}.bezier-preset-selected .bezier-preset-modify{opacity:100%}.bezier-preset-category{width:50px;cursor:pointer;transition:transform 100ms cubic-bezier(0.4,0,0.2,1)}span.bezier-display-value{width:100%;user-select:text;display:block;text-align:center;line-height:20px;min-height:20px;cursor:text}svg.bezier-curve{margin-left:32px;margin-top:-8px}svg.bezier-curve.linear{margin-top:42px;overflow:visible}svg.bezier-preset-modify.bezier-preset-plus{right:0}.bezier-header{margin-top:16px;z-index:1}svg.bezier-preset-modify:active{transform:scale(1.1);background-color:var(--sys-color-state-ripple-neutral-on-subtle)}.bezier-preset-category:active{transform:scale(1.05)}.bezier-header-active > svg.bezier-preset-modify{visibility:visible}.bezier-preset-modify:active path{stroke:var(--sys-color-on-surface-subtle)}\n/*# sourceURL=${import.meta.resolve("./bezierEditor.css")} */\n`};class F extends(s.ObjectWrapper.eventMixin(e.Widget.VBox)){model;previewElement;previewOnion;outerContainer;selectedCategory;presetsContainer;presetUI;presetCategories;animationTimingUI;header;label;previewAnimation;debouncedStartPreviewAnimation;constructor(e){super(!0),this.registerRequiredCSS(L),this.model=e,this.contentElement.tabIndex=0,this.contentElement.setAttribute("jslog",`${n.dialog("bezierEditor").parent("mapped").track({keydown:"Enter|Escape"})}`),this.setDefaultFocusedElement(this.contentElement),this.element.style.overflowY="auto",this.previewElement=this.contentElement.createChild("div","bezier-preview-container"),this.previewElement.setAttribute("jslog",`${n.preview().track({click:!0})}`),this.previewElement.createChild("div","bezier-preview-animation"),this.previewElement.addEventListener("click",this.startPreviewAnimation.bind(this)),this.previewOnion=this.contentElement.createChild("div","bezier-preview-onion"),this.previewOnion.setAttribute("jslog",`${n.preview().track({click:!0})}`),this.previewOnion.addEventListener("click",this.startPreviewAnimation.bind(this)),this.outerContainer=this.contentElement.createChild("div","bezier-container"),this.selectedCategory=null,this.presetsContainer=this.outerContainer.createChild("div","bezier-presets"),this.presetUI=new M,this.presetCategories=[];for(let e=0;e<B.length;e++){const t=this.createCategory(B[e]);t&&(this.presetCategories[e]=t,this.presetsContainer.appendChild(this.presetCategories[e].icon))}this.debouncedStartPreviewAnimation=s.Debouncer.debounce(this.startPreviewAnimation.bind(this),300),this.animationTimingUI=new A({model:this.model,onChange:e=>{this.setModel(e),this.onchange(),this.unselectPresets(),this.debouncedStartPreviewAnimation()}}),this.animationTimingUI.element().setAttribute("jslog",`${n.bezierCurveEditor().track({click:!0,drag:!0})}`),this.outerContainer.appendChild(this.animationTimingUI.element()),this.header=this.contentElement.createChild("div","bezier-header");const t=this.createPresetModifyIcon(this.header,"bezier-preset-minus","M 12 6 L 8 10 L 12 14");t.addEventListener("click",this.presetModifyClicked.bind(this,!1)),t.setAttribute("jslog",`${n.action("bezier.prev-preset").track({click:!0})}`);const i=this.createPresetModifyIcon(this.header,"bezier-preset-plus","M 8 6 L 12 10 L 8 14");i.addEventListener("click",this.presetModifyClicked.bind(this,!0)),i.setAttribute("jslog",`${n.action("bezier.next-preset").track({click:!0})}`),this.label=this.header.createChild("span","source-code bezier-display-value")}setModel(e){this.model=e,this.animationTimingUI?.setModel(this.model),this.updateUI()}wasShown(){this.unselectPresets();for(const e of this.presetCategories)for(let t=0;t<e.presets.length;t++)this.model.asCSSText()===e.presets[t].value&&(e.presetIndex=t,this.presetCategorySelected(e));this.updateUI(),this.startPreviewAnimation()}onchange(){this.updateUI(),this.dispatchEventToListeners("BezierChanged",this.model.asCSSText())}updateUI(){const e=this.selectedCategory?this.selectedCategory.presets[this.selectedCategory.presetIndex].name:this.model.asCSSText().replace(/\s(-\d\.\d)/g,"$1");this.label.textContent=e,this.animationTimingUI?.draw()}createCategory(t){const i=y.parse(t[0].value);if(!i)return null;const s=document.createElement("div");s.classList.add("bezier-preset-category"),s.setAttribute("jslog",`${n.bezierPresetCategory().track({click:!0}).context(t[0].name)}`);const o=e.UIUtils.createSVGChild(s,"svg","bezier-preset monospace"),r={presets:t,presetIndex:0,icon:s};return this.presetUI.draw(i,o),o.addEventListener("click",this.presetCategorySelected.bind(this,r)),r}createPresetModifyIcon(t,i,n){const s=e.UIUtils.createSVGChild(t,"svg","bezier-preset-modify "+i);s.setAttribute("width","20"),s.setAttribute("height","20");return e.UIUtils.createSVGChild(s,"path").setAttribute("d",n),s}unselectPresets(){for(const e of this.presetCategories)e.icon.classList.remove("bezier-preset-selected");this.selectedCategory=null,this.header.classList.remove("bezier-header-active")}presetCategorySelected(e,t){if(this.selectedCategory===e)return;this.unselectPresets(),this.header.classList.add("bezier-header-active"),this.selectedCategory=e,this.selectedCategory.icon.classList.add("bezier-preset-selected");const i=y.parse(e.presets[e.presetIndex].value);i&&(this.setModel(i),this.onchange(),this.startPreviewAnimation()),t&&t.consume(!0)}presetModifyClicked(e,t){if(null===this.selectedCategory)return;const i=this.selectedCategory.presets.length;this.selectedCategory.presetIndex=(this.selectedCategory.presetIndex+(e?1:-1)+i)%i;const n=this.selectedCategory.presets[this.selectedCategory.presetIndex].value,s=y.parse(n);s&&(this.setModel(s),this.onchange(),this.startPreviewAnimation())}startPreviewAnimation(){this.previewOnion.removeChildren(),this.previewAnimation&&this.previewAnimation.cancel();const e=1600;this.previewAnimation=this.previewElement.animate([{offset:0,transform:"translateX(0px)",opacity:1},{offset:1,transform:"translateX(218px)",opacity:1}],{easing:this.model.asCSSText(),duration:e}),this.previewOnion.removeChildren();for(let t=0;t<=20;t++){const i=this.previewOnion.createChild("div","bezier-preview-animation").animate([{transform:"translateX(0px)",easing:this.model.asCSSText()},{transform:"translateX(218px)"}],{duration:e,fill:"forwards"});i.pause(),i.currentTime=e*t/20}}}const B=[[{name:"linear",value:"linear"},{name:"elastic",value:"linear(0 0%, 0.22 2.1%, 0.86 6.5%, 1.11 8.6%, 1.3 10.7%, 1.35 11.8%, 1.37 12.9%, 1.37 13.7%, 1.36 14.5%, 1.32 16.2%, 1.03 21.8%, 0.94 24%, 0.89 25.9%, 0.88 26.85%, 0.87 27.8%, 0.87 29.25%, 0.88 30.7%, 0.91 32.4%, 0.98 36.4%, 1.01 38.3%, 1.04 40.5%, 1.05 42.7%, 1.05 44.1%, 1.04 45.7%, 1 53.3%, 0.99 55.4%, 0.98 57.5%, 0.99 60.7%, 1 68.1%, 1.01 72.2%, 1 86.7%, 1 100%)"},{name:"bounce",value:"linear(0 0%, 0 2.27%, 0.02 4.53%, 0.04 6.8%, 0.06 9.07%, 0.1 11.33%, 0.14 13.6%, 0.25 18.15%, 0.39 22.7%, 0.56 27.25%, 0.77 31.8%, 1 36.35%, 0.89 40.9%, 0.85 43.18%, 0.81 45.45%, 0.79 47.72%, 0.77 50%, 0.75 52.27%, 0.75 54.55%, 0.75 56.82%, 0.77 59.1%, 0.79 61.38%, 0.81 63.65%, 0.85 65.93%, 0.89 68.2%, 1 72.7%, 0.97 74.98%, 0.95 77.25%, 0.94 79.53%, 0.94 81.8%, 0.94 84.08%, 0.95 86.35%, 0.97 88.63%, 1 90.9%, 0.99 93.18%, 0.98 95.45%, 0.99 97.73%, 1 100%)"},{name:"emphasized",value:"linear(0 0%, 0 1.8%, 0.01 3.6%, 0.03 6.35%, 0.07 9.1%, 0.13 11.4%, 0.19 13.4%, 0.27 15%, 0.34 16.1%, 0.54 18.35%, 0.66 20.6%, 0.72 22.4%, 0.77 24.6%, 0.81 27.3%, 0.85 30.4%, 0.88 35.1%, 0.92 40.6%, 0.94 47.2%, 0.96 55%, 0.98 64%, 0.99 74.4%, 1 86.4%, 1 100%)"}],[{name:"ease-in-out",value:"ease-in-out"},{name:"In Out · Sine",value:"cubic-bezier(0.45, 0.05, 0.55, 0.95)"},{name:"In Out · Quadratic",value:"cubic-bezier(0.46, 0.03, 0.52, 0.96)"},{name:"In Out · Cubic",value:"cubic-bezier(0.65, 0.05, 0.36, 1)"},{name:"Fast Out, Slow In",value:"cubic-bezier(0.4, 0, 0.2, 1)"},{name:"In Out · Back",value:"cubic-bezier(0.68, -0.55, 0.27, 1.55)"}],[{name:"Fast Out, Linear In",value:"cubic-bezier(0.4, 0, 1, 1)"},{name:"ease-in",value:"ease-in"},{name:"In · Sine",value:"cubic-bezier(0.47, 0, 0.75, 0.72)"},{name:"In · Quadratic",value:"cubic-bezier(0.55, 0.09, 0.68, 0.53)"},{name:"In · Cubic",value:"cubic-bezier(0.55, 0.06, 0.68, 0.19)"},{name:"In · Back",value:"cubic-bezier(0.6, -0.28, 0.74, 0.05)"}],[{name:"ease-out",value:"ease-out"},{name:"Out · Sine",value:"cubic-bezier(0.39, 0.58, 0.57, 1)"},{name:"Out · Quadratic",value:"cubic-bezier(0.25, 0.46, 0.45, 0.94)"},{name:"Out · Cubic",value:"cubic-bezier(0.22, 0.61, 0.36, 1)"},{name:"Linear Out, Slow In",value:"cubic-bezier(0, 0, 0.2, 1)"},{name:"Out · Back",value:"cubic-bezier(0.18, 0.89, 0.32, 1.28)"}]];var R=Object.freeze({__proto__:null,BezierEditor:F,Presets:B}),O={cssText:`.swatch-icon{display:inline-grid;inline-size:15px;grid:[stack] 1fr/[stack] 1fr;margin-left:1px;margin-right:1px;vertical-align:-1px;color:var(--color)}.swatch{aspect-ratio:1/1;display:inline-block;width:10px;border-radius:1e5px;background:linear-gradient(var(--color),var(--color)),var(--image-file-checker);box-shadow:inset 0 0 0 0.5px rgb(128 128 128/60%);grid-area:stack}.swatch-right{justify-self:end}.swatch-mix{box-shadow:none;justify-self:end;mask:radial-gradient(circle at 0% center,rgb(0 0 0) 50%,rgb(0 0 0/0%) calc(50% + 0.5px))}\n/*# sourceURL=${import.meta.resolve("./colorMixSwatch.css")} */\n`};const $=new CSSStyleSheet;$.replaceSync(O.cssText);const{html:D,render:N,Directives:{ref:_}}=o;class j extends Event{static eventName="colormixchanged";data;constructor(e){super(j.eventName,{}),this.data={text:e}}}class H extends HTMLElement{shadow=this.attachShadow({mode:"open"});colorMixText="";firstColorText="";secondColorText="";#A=null;constructor(){super(),this.shadow.adoptedStyleSheets=[$]}mixedColor(){const e=this.#A?.computedStyleMap().get("color")?.toString()??null;return e?s.Color.parse(e):null}setFirstColor(e){this.firstColorText&&(this.colorMixText=this.colorMixText.replace(this.firstColorText,e)),this.firstColorText=e,this.dispatchEvent(new j(this.colorMixText)),this.#U()}setSecondColor(e){this.secondColorText&&(this.colorMixText=i.StringUtilities.replaceLast(this.colorMixText,this.secondColorText,e)),this.secondColorText=e,this.dispatchEvent(new j(this.colorMixText)),this.#U()}setColorMixText(e){this.colorMixText=e,this.dispatchEvent(new j(this.colorMixText)),this.#U()}getText(){return this.colorMixText}#U(){this.colorMixText&&this.firstColorText&&this.secondColorText?N(D`<div class="swatch-icon"
      ${_((e=>{this.#A=e}))}
      jslog=${n.cssColorMix()}
      style="--color: ${this.colorMixText}">
        <span class="swatch swatch-left" id="swatch-1" style="--color: ${this.firstColorText}"></span>
        <span class="swatch swatch-right" id="swatch-2" style="--color: ${this.secondColorText}"></span>
        <span class="swatch swatch-mix" id="mix-result" style="--color: ${this.colorMixText}"></span></div>`,this.shadow,{host:this}):N(this.colorMixText,this.shadow,{host:this})}}customElements.define("devtools-color-mix-swatch",H);var V=Object.freeze({__proto__:null,ColorMixChangedEvent:j,ColorMixSwatch:H}),G={cssText:`:host{white-space:nowrap}.color-swatch{position:relative;margin-left:1px;margin-right:2px;width:12px;height:12px;transform:scale(0.8);vertical-align:-2px;display:inline-block;user-select:none;background-image:var(--image-file-checker);line-height:10px}.color-swatch-inner{width:100%;height:100%;display:inline-block;border:1px solid var(--sys-color-neutral-outline);box-sizing:border-box;cursor:pointer}.color-swatch.readonly .color-swatch-inner{cursor:unset}.color-swatch:not(.readonly) .color-swatch-inner:hover{border:1px solid var(--sys-color-outline)}@media (forced-colors: active){.color-swatch{forced-color-adjust:none}}\n/*# sourceURL=${import.meta.resolve("./colorSwatch.css")} */\n`};const K=new CSSStyleSheet;K.replaceSync(G.cssText);const{html:W}=o,X={shiftclickToChangeColorFormat:"Shift-click to change color format"},Y=l.i18n.registerUIStrings("ui/legacy/components/inline_editor/ColorSwatch.ts",X),q=l.i18n.getLocalizedString.bind(void 0,Y);class Z extends Event{static eventName="colorchanged";data;constructor(e){super(Z.eventName,{}),this.data={color:e}}}class Q extends Event{static eventName="swatchclick";constructor(){super(Q.eventName,{})}}class J extends HTMLElement{shadow=this.attachShadow({mode:"open"});tooltip=q(X.shiftclickToChangeColorFormat);color=null;readonly=!1;constructor(e){super(),this.shadow.adoptedStyleSheets=[K],e&&(this.tooltip=e)}static isColorSwatch(e){return"devtools-color-swatch"===e.localName}setReadonly(e){this.readonly!==e&&(this.readonly=e,this.color&&this.renderColor(this.color))}getColor(){return this.color}get anchorBox(){const e=this.shadow.querySelector(".color-swatch");return e?e.boxInWindow():null}getText(){return this.color?.getAuthoredText()??this.color?.asString()}renderColor(e){this.color=e;const t=o.Directives.classMap({"color-swatch":!0,readonly:this.readonly});o.render(W`<span class=${t} title=${this.tooltip}><span class="color-swatch-inner"
        style="background-color: ${e.asString()};"
        jslog=${n.showStyleEditor("color").track({click:!0})}
        @click=${this.onClick}
        @mousedown=${this.consume}
        @dblclick=${this.consume}></span></span><slot><span>${this.getText()}</span></slot>`,this.shadow,{host:this})}onClick(e){if(!this.readonly)return e.shiftKey?(e.stopPropagation(),void this.showFormatPicker(e)):void this.dispatchEvent(new Q)}consume(e){e.stopPropagation()}setColor(e){this.renderColor(e),this.dispatchEvent(new Z(e))}setColorText(e){this.firstElementChild?.remove(),this.renderColor(e);this.appendChild(document.createElement("span")).appendChild(document.createTextNode(e.getAuthoredText()??e.asString())),this.dispatchEvent(new Z(e))}showFormatPicker(e){if(!this.color)return;new d.FormatPickerContextMenu.FormatPickerContextMenu(this.color).show(e,(e=>{this.setColorText(e)}))}}customElements.define("devtools-color-swatch",J);var ee=Object.freeze({__proto__:null,ClickEvent:Q,ColorChangedEvent:Z,ColorSwatch:J}),te={cssText:`.editor.interacting::before{content:"";position:fixed;inset:0}.clock,\n.pointer,\n.center,\n.hand,\n.dial{position:absolute}.clock{top:6px;width:6em;height:6em;background-color:var(--sys-color-cdt-base-container);border:0.5em solid var(--sys-color-neutral-outline);border-radius:9em;box-shadow:var(--drop-shadow),inset 0 0 15px var(--box-shadow-outline-color);transform:translateX(-3em)}.center,\n.hand{box-shadow:0 0 2px var(--box-shadow-outline-color)}.pointer{margin:auto;top:0;left:-0.4em;right:0;width:0;height:0;border-style:solid;border-width:0 0.9em 0.9em;border-color:transparent transparent var(--sys-color-neutral-outline) transparent}.center,\n.hand,\n.dial{margin:auto;inset:0}.center{width:0.7em;height:0.7em;border-radius:10px}.dial{width:2px;height:var(--clock-dial-length);background-color:var(--override-dial-color);border-radius:1px}.hand{height:50%;width:0.3em;background:var(--sys-color-tonal-container)}.hand::before{content:"";display:inline-block;position:absolute;top:-0.6em;left:-0.35em;width:1em;height:1em;border-radius:50%;cursor:pointer;box-shadow:0 0 5px var(--box-shadow-outline-color)}.hand::before,\n.center{background-color:var(--sys-color-tonal-container)}:host-context(.theme-with-dark-background) .hand::before{box-shadow:0 0 5px hsl(0deg 0% 0%/80%)}:host-context(.theme-with-dark-background) .center,\n:host-context(.theme-with-dark-background) .hand{box-shadow:0 0 2px hsl(0deg 0% 0%/60%)}:host-context(.theme-with-dark-background) .clock{background-color:hsl(225deg 5% 27%)}\n/*# sourceURL=${import.meta.resolve("./cssAngleEditor.css")} */\n`};const ie=/(?<value>[+-]?\d*\.?\d+)(?<unit>deg|grad|rad|turn)/,ne=e=>{const t=e.match(ie);return t?.groups?{value:Number(t.groups.value),unit:t.groups.unit}:null},se=(t,i)=>{let n=t;switch(i){case"grad":n=e.Geometry.radiansToGradians(t);break;case"deg":n=e.Geometry.radiansToDegrees(t);break;case"turn":n=e.Geometry.radiansToTurns(t)}return{value:n,unit:i}},oe=t=>{switch(t.unit){case"deg":return e.Geometry.degreesToRadians(t.value);case"grad":return e.Geometry.gradiansToRadians(t.value);case"turn":return e.Geometry.turnsToRadians(t.value)}return t.value},re=(e,t)=>{const i=oe(e);return{translateX:Math.sin(i)*t,translateY:-Math.cos(i)*t}},ae=e=>{let t=e.value;switch(e.unit){case"deg":case"grad":t=Math.round(e.value);break;case"rad":t=Math.round(1e4*e.value)/1e4;break;case"turn":t=Math.round(100*e.value)/100;break;default:i.assertNever(e.unit,`Unknown angle unit: ${e.unit}`)}return{value:t,unit:e.unit}},le=e=>{switch(e){case"deg":return"grad";case"grad":return"rad";case"rad":return"turn";default:return"deg"}},de=(e,t)=>{if(e.unit===t)return e;const i=oe(e);return se(i,t)},he=(t,i)=>{const n=e.UIUtils.getValueModificationDirection(i);if(null===n)return;let s="Up"===n?Math.PI/180:-Math.PI/180;i.shiftKey&&(s*=10);const o=oe(t);return se(o+s,t.unit)};var ce=Object.freeze({__proto__:null,CSSAngleRegex:ie,convertAngleUnit:de,get2DTranslationsForAngle:re,getAngleFromRadians:se,getNewAngleFromEvent:he,getNextUnit:le,getRadiansFromAngle:oe,parseText:ne,roundAngleByUnit:ae});const ue=new CSSStyleSheet;ue.replaceSync(te.cssText);const{render:pe,html:me}=o,ge=o.Directives.styleMap;class ve extends HTMLElement{shadow=this.attachShadow({mode:"open"});angle={value:0,unit:"rad"};onAngleUpdate;background="";clockRadius=38.5;dialTemplates;mousemoveThrottler=new s.Throttler.Throttler(16.67);mousemoveListener=this.onMousemove.bind(this);connectedCallback(){this.shadow.adoptedStyleSheets=[ue],this.style.setProperty("--clock-dial-length","6px")}set data(e){this.angle=e.angle,this.onAngleUpdate=e.onAngleUpdate,this.background=e.background,this.render()}updateAngleFromMousePosition(e,t,i){const n=this.shadow.querySelector(".clock");if(!n||!this.onAngleUpdate)return;const{top:s,right:o,bottom:r,left:a}=n.getBoundingClientRect();this.clockRadius=(o-a)/2;const l=(a+o)/2,d=(r+s)/2,h=-Math.atan2(e-l,t-d)+Math.PI;if(i){const e=oe({value:15,unit:"deg"}),t=Math.round(h/e)*e;this.onAngleUpdate(se(t,this.angle.unit))}else this.onAngleUpdate(se(h,this.angle.unit))}onEditorMousedown(e){e.stopPropagation(),this.updateAngleFromMousePosition(e.pageX,e.pageY,e.shiftKey);const t=e.target instanceof Node&&e.target.ownerDocument,i=this.shadow.querySelector(".editor");t&&i&&(t.addEventListener("mousemove",this.mousemoveListener,{capture:!0}),i.classList.add("interacting"),t.addEventListener("mouseup",(()=>{t.removeEventListener("mousemove",this.mousemoveListener,{capture:!0}),i.classList.remove("interacting")}),{once:!0}))}onMousemove(e){1===e.buttons&&(e.preventDefault(),this.mousemoveThrottler.schedule((()=>(this.updateAngleFromMousePosition(e.pageX,e.pageY,e.shiftKey),Promise.resolve()))))}onEditorWheel(e){if(!this.onAngleUpdate)return;const t=he(this.angle,e);t&&this.onAngleUpdate(t),e.preventDefault()}render(){const e={background:this.background},{translateX:t,translateY:i}=re(this.angle,this.clockRadius/2),s={transform:`translate(${t}px, ${i}px) rotate(${this.angle.value}${this.angle.unit})`};pe(me`
      <div class="editor" jslog=${n.dialog("cssAngleEditor").track({click:!0,drag:!0,resize:!0,keydown:"Enter|Escape"})}>
        <span class="pointer"></span>
        <div
          class="clock"
          style=${ge(e)}
          @mousedown=${this.onEditorMousedown}
          @wheel=${this.onEditorWheel}>
          ${this.renderDials()}
          <div class="hand" style=${ge(s)}></div>
          <span class="center"></span>
        </div>
      </div>
    `,this.shadow,{host:this})}renderDials(){return this.dialTemplates||(this.dialTemplates=[0,45,90,135,180,225,270,315].map((e=>{const t=this.clockRadius-6-3,{translateX:i,translateY:n}=re({value:e,unit:"deg"},t);return me`<span class="dial" style=${ge({transform:`translate(${i}px, ${n}px) rotate(${e}deg)`})}></span>`}))),this.dialTemplates}}customElements.define("devtools-css-angle-editor",ve);var xe={cssText:`.swatch{position:relative;display:inline-block;margin-bottom:-2px;width:1em;height:1em;border:1px solid var(--sys-color-neutral-outline);border-radius:50%;overflow:hidden;cursor:pointer;background-color:var(--sys-color-neutral-container)}.mini-hand{position:absolute;margin:auto;inset:0;height:55%;width:2px;background-color:var(--sys-color-tonal-container);border-radius:5px}\n/*# sourceURL=${import.meta.resolve("./cssAngleSwatch.css")} */\n`};const be=new CSSStyleSheet;be.replaceSync(xe.cssText);const{render:fe,html:we}=o,ye=o.Directives.styleMap;class Se extends HTMLElement{shadow=this.attachShadow({mode:"open"});angle={value:0,unit:"rad"};connectedCallback(){this.shadow.adoptedStyleSheets=[be]}set data(e){this.angle=e.angle,this.render()}render(){const{translateX:e,translateY:t}=re(this.angle,2.75),i={transform:`translate(${e}px, ${t}px) rotate(${this.angle.value}${this.angle.unit})`};fe(we`
      <div class="swatch">
        <span class="mini-hand" style=${ye(i)}></span>
      </div>
    `,this.shadow,{host:this})}}customElements.define("devtools-css-angle-swatch",Se);var Ce={cssText:`.css-angle{display:inline-block;position:relative;outline:none}devtools-css-angle-swatch{display:inline-block;margin-right:2px;user-select:none}devtools-css-angle-editor{--override-dial-color:var(--sys-color-neutral-outline);position:fixed;z-index:2}.preview{display:inline-block}\n/*# sourceURL=${import.meta.resolve("./cssAngle.css")} */\n`};class Ie extends Event{static eventName="valuechanged";data;constructor(e){super(Ie.eventName,{}),this.data={value:e}}}var ke=Object.freeze({__proto__:null,ValueChangedEvent:Ie});const Ee=new CSSStyleSheet;Ee.replaceSync(Ce.cssText);const{render:Pe,html:Te}=o,ze=o.Directives.styleMap;class Me extends Event{static eventName="popovertoggled";data;constructor(e){super(Me.eventName,{}),this.data={open:e}}}class Ae extends Event{static eventName="unitchanged";data;constructor(e){super(Ae.eventName,{}),this.data={value:e}}}const Ue={value:0,unit:"rad"};class Le extends HTMLElement{shadow=this.attachShadow({mode:"open"});angle=Ue;displayedAngle=Ue;propertyValue="";containingPane;angleElement=null;swatchElement=null;popoverOpen=!1;popoverStyleTop="";popoverStyleLeft="";onMinifyingAction=this.minify.bind(this);connectedCallback(){this.shadow.adoptedStyleSheets=[Ee]}set data(e){const t=ne(e.angleText);t&&(this.angle=t,this.displayedAngle={...t},this.containingPane=e.containingPane,this.render())}disconnectedCallback(){this.unbindMinifyingAction()}popOver(){if(!this.containingPane)return;if(this.angleElement||(this.angleElement=this.shadow.querySelector(".css-angle")),this.swatchElement||(this.swatchElement=this.shadow.querySelector("devtools-css-angle-swatch")),!this.angleElement||!this.swatchElement)return;this.dispatchEvent(new Me(!0)),this.bindMinifyingAction();const e=this.swatchElement.getBoundingClientRect().bottom,t=this.swatchElement.getBoundingClientRect().left;if(e&&t){const i=this.containingPane.getBoundingClientRect().top,n=this.containingPane.getBoundingClientRect().left;this.popoverStyleTop=e-i+"px",this.popoverStyleLeft=t-n+"px"}this.popoverOpen=!0,this.render(),this.angleElement.focus()}addEventListener(e,t,i){super.addEventListener(e,t,i)}minify(){!1!==this.popoverOpen&&(this.popoverOpen=!1,this.dispatchEvent(new Me(!1)),this.unbindMinifyingAction(),this.render())}updateProperty(e){this.propertyValue=e,this.render()}updateAngle(e){this.displayedAngle=ae(de(e,this.displayedAngle.unit)),this.angle=this.displayedAngle,this.dispatchEvent(new Ie(`${this.angle.value}${this.angle.unit}`)),this.render()}displayNextUnit(){const e=le(this.displayedAngle.unit);this.displayedAngle=ae(de(this.angle,e)),this.dispatchEvent(new Ae(`${this.displayedAngle.value}${this.displayedAngle.unit}`))}bindMinifyingAction(){document.addEventListener("mousedown",this.onMinifyingAction),this.containingPane&&this.containingPane.addEventListener("scroll",this.onMinifyingAction)}unbindMinifyingAction(){document.removeEventListener("mousedown",this.onMinifyingAction),this.containingPane&&this.containingPane.removeEventListener("scroll",this.onMinifyingAction)}onMiniIconClick(e){e.stopPropagation(),!e.shiftKey||this.popoverOpen?this.popoverOpen?this.minify():this.popOver():this.displayNextUnit()}consume(e){e.stopPropagation()}onKeydown(e){if(this.popoverOpen)switch(e.key){case"Escape":e.stopPropagation(),this.minify(),this.blur();break;case"ArrowUp":case"ArrowDown":{const t=he(this.angle,e);t&&this.updateAngle(t),e.preventDefault();break}}}render(){Pe(Te`
      <div class="css-angle" @focusout=${this.minify} @keydown=${this.onKeydown} tabindex="-1">
        <div class="preview">
          <devtools-css-angle-swatch
            @click=${this.onMiniIconClick}
            @mousedown=${this.consume}
            @dblclick=${this.consume}
            .data=${{angle:this.angle}}>
          </devtools-css-angle-swatch><slot></slot></div>
        ${this.popoverOpen?this.renderPopover():null}
      </div>
    `,this.shadow,{host:this})}renderPopover(){let e="";return this.propertyValue&&!this.propertyValue.match(/url\(.*\)/i)&&(e=this.propertyValue),Te`
    <devtools-css-angle-editor
      class="popover popover-css-angle"
      style=${ze({top:this.popoverStyleTop,left:this.popoverStyleLeft})}
      .data=${{angle:this.angle,onAngleUpdate:e=>{this.updateAngle(e)},background:e}}
    ></devtools-css-angle-editor>
    `}}customElements.define("devtools-css-angle",Le);var Fe=Object.freeze({__proto__:null,CSSAngle:Le,PopoverToggledEvent:Me,UnitChangedEvent:Ae}),Be={cssText:`:host{user-select:none;border:1px solid transparent}.shadow-editor-field{height:24px;margin-top:8px;font-size:12px;flex-shrink:0}.shadow-editor-field:last-of-type{margin-bottom:8px}.shadow-editor-flex-field{display:flex;align-items:center;flex-direction:row}.shadow-editor-field.shadow-editor-blur-field{margin-top:40px}.shadow-editor-2D-slider{position:absolute;height:88px;width:88px;border:1px solid var(--divider-line);border-radius:2px}.shadow-editor-label{display:inline-block;width:52px;height:24px;line-height:24px;margin-right:8px;text-align:right}.shadow-editor-button-left,\n.shadow-editor-button-right{width:74px;height:24px;padding:3px 7px;line-height:16px;border:1px solid var(--divider-line);color:var(--sys-color-on-surface);background-color:var(--sys-color-cdt-base-container);text-align:center;font-weight:500}.shadow-editor-button-left{border-radius:2px 0 0 2px}.shadow-editor-button-right{border-radius:0 2px 2px 0;border-left-width:0}.shadow-editor-button-left:hover,\n.shadow-editor-button-right:hover{box-shadow:0 1px 1px var(--color-background-elevation-1)}.shadow-editor-button-left:focus,\n.shadow-editor-button-right:focus{background-color:var(--color-background-elevation-1)}.shadow-editor-button-left.enabled,\n.shadow-editor-button-right.enabled{--override-button-text-color:#fff;background-color:var(--color-primary-old);color:var(--override-button-text-color)}.shadow-editor-button-left.enabled:focus,\n.shadow-editor-button-right.enabled:focus{background-color:var(--color-primary-variant)}.shadow-editor-text-input{width:52px;margin-right:8px;text-align:right;box-shadow:var(--legacy-focus-ring-inactive-shadow)}@media (forced-colors: active){.shadow-editor-button-left:hover,\n  .shadow-editor-button-left.enabled:focus,\n  .shadow-editor-button-right:hover .shadow-editor-button-left.enabled,\n  .shadow-editor-button-right.enabled,\n  .shadow-editor-button-right.enabled:focus{forced-color-adjust:none;background-color:Highlight;color:HighlightText}}\n/*# sourceURL=${import.meta.resolve("./cssShadowEditor.css")} */\n`};const Re={type:"Type",xOffset:"X offset",yOffset:"Y offset",blur:"Blur",spread:"Spread"},Oe=l.i18n.registerUIStrings("ui/legacy/components/inline_editor/CSSShadowEditor.ts",Re),$e=l.i18n.getLocalizedString.bind(void 0,Oe),De=20,Ne="px",_e=new RegExp("([+-]?(?:[0-9]*[.])?[0-9]+(?:[eE][+-]?[0-9]+)?)(ch|cm|em|ex|in|mm|pc|pt|px|rem|vh|vmax|vmin|vw)|[+-]?(?:0*[.])?0+(?:[eE][+-]?[0-9]+)?","gi").source;class je{amount;unit;constructor(e,t){this.amount=e,this.unit=t}static parse(e){const t=new RegExp("^(?:"+_e+")$","i"),i=e.match(t);return i?i.length>2&&i[2]?new je(parseFloat(i[1]),i[2]):je.zero():null}static zero(){return new je(0,"")}asCSSText(){return this.amount+this.unit}}class He extends(s.ObjectWrapper.eventMixin(e.Widget.VBox)){typeField;outsetButton;insetButton;xInput;yInput;xySlider;halfCanvasSize;innerCanvasSize;blurInput;blurSlider;spreadField;spreadInput;spreadSlider;model;canvasOrigin;changedElement;constructor(){super(!0),this.registerRequiredCSS(Be),this.contentElement.tabIndex=0,this.contentElement.setAttribute("jslog",`${n.dialog("cssShadowEditor").parent("mapped").track({keydown:"Enter|Escape"})}`),this.setDefaultFocusedElement(this.contentElement),this.typeField=this.contentElement.createChild("div","shadow-editor-field shadow-editor-flex-field"),this.typeField.createChild("label","shadow-editor-label").textContent=$e(Re.type),this.outsetButton=this.typeField.createChild("button","shadow-editor-button-left"),this.outsetButton.textContent=l.i18n.lockedString("Outset"),this.outsetButton.addEventListener("click",this.onButtonClick.bind(this),!1),this.insetButton=this.typeField.createChild("button","shadow-editor-button-right"),this.insetButton.textContent=l.i18n.lockedString("Inset"),this.insetButton.addEventListener("click",this.onButtonClick.bind(this),!1);const t=this.contentElement.createChild("div","shadow-editor-field");this.xInput=this.createTextInput(t,$e(Re.xOffset),"x-offset");const i=this.contentElement.createChild("div","shadow-editor-field");this.yInput=this.createTextInput(i,$e(Re.yOffset),"y-offset"),this.xySlider=t.createChild("canvas","shadow-editor-2D-slider"),this.xySlider.setAttribute("jslog",`${n.slider("xy").track({click:!0,drag:!0,keydown:"ArrowUp|ArrowDown|ArrowLeft|ArrowRight"})}`),this.xySlider.width=88,this.xySlider.height=88,this.xySlider.tabIndex=-1,this.halfCanvasSize=44,this.innerCanvasSize=this.halfCanvasSize-6,e.UIUtils.installDragHandle(this.xySlider,this.dragStart.bind(this),this.dragMove.bind(this),null,"default"),this.xySlider.addEventListener("keydown",this.onCanvasArrowKey.bind(this),!1),this.xySlider.addEventListener("blur",this.onCanvasBlur.bind(this),!1);const s=this.contentElement.createChild("div","shadow-editor-field shadow-editor-flex-field shadow-editor-blur-field");this.blurInput=this.createTextInput(s,$e(Re.blur),"blur"),this.blurSlider=this.createSlider(s,"blur"),this.spreadField=this.contentElement.createChild("div","shadow-editor-field shadow-editor-flex-field"),this.spreadInput=this.createTextInput(this.spreadField,$e(Re.spread),"spread"),this.spreadSlider=this.createSlider(this.spreadField,"spread")}createTextInput(t,i,s){const o=t.createChild("label","shadow-editor-label");o.textContent=i,o.setAttribute("for",i);const r=e.UIUtils.createInput("shadow-editor-text-input","text");return t.appendChild(r),r.id=i,r.addEventListener("keydown",this.handleValueModification.bind(this),!1),r.addEventListener("wheel",this.handleValueModification.bind(this),!1),r.addEventListener("input",this.onTextInput.bind(this),!1),r.addEventListener("blur",this.onTextBlur.bind(this),!1),r.setAttribute("jslog",`${n.value().track({change:!0,keydown:"ArrowUp|ArrowDown"}).context(s)}`),r}createSlider(t,i){const s=e.UIUtils.createSlider(0,De,-1);return s.addEventListener("input",this.onSliderInput.bind(this),!1),s.setAttribute("jslog",`${n.slider().track({click:!0,drag:!0}).context(i)}`),t.appendChild(s),s}wasShown(){super.wasShown(),this.updateUI()}setModel(e){this.model=e,this.typeField.classList.toggle("hidden",!e.isBoxShadow()),this.spreadField.classList.toggle("hidden",!e.isBoxShadow()),this.updateUI()}updateUI(){this.updateButtons(),this.xInput.value=this.model.offsetX().asCSSText(),this.yInput.value=this.model.offsetY().asCSSText(),this.blurInput.value=this.model.blurRadius().asCSSText(),this.spreadInput.value=this.model.spreadRadius().asCSSText(),this.blurSlider.value=this.model.blurRadius().amount.toString(),this.spreadSlider.value=this.model.spreadRadius().amount.toString(),this.updateCanvas(!1)}updateButtons(){this.insetButton.classList.toggle("enabled",this.model.inset()),this.outsetButton.classList.toggle("enabled",!this.model.inset())}updateCanvas(e){const t=this.xySlider.getContext("2d");if(!t)throw new Error("Unable to obtain canvas context");t.clearRect(0,0,this.xySlider.width,this.xySlider.height),t.save(),t.setLineDash([1,1]),t.strokeStyle="rgba(210, 210, 210, 0.8)",t.beginPath(),t.moveTo(this.halfCanvasSize,0),t.lineTo(this.halfCanvasSize,88),t.moveTo(0,this.halfCanvasSize),t.lineTo(88,this.halfCanvasSize),t.stroke(),t.restore();const i=this.sliderThumbPosition();t.save(),t.translate(this.halfCanvasSize,this.halfCanvasSize),t.lineWidth=2,t.strokeStyle="rgba(130, 130, 130, 0.75)",t.beginPath(),t.moveTo(0,0),t.lineTo(i.x,i.y),t.stroke(),e&&(t.beginPath(),t.fillStyle="rgba(66, 133, 244, 0.4)",t.arc(i.x,i.y,8,0,2*Math.PI),t.fill()),t.beginPath(),t.fillStyle="#4285F4",t.arc(i.x,i.y,6,0,2*Math.PI),t.fill(),t.restore()}onButtonClick(e){const t=e.currentTarget===this.insetButton;t&&this.model.inset()||!t&&!this.model.inset()||(this.model.setInset(t),this.updateButtons(),this.dispatchEventToListeners("ShadowChanged",this.model))}handleValueModification(t){const i=t.currentTarget,n=e.UIUtils.createReplacementString(i.value,t,(function(e,t,i){i.length||(i=Ne);return e+t+i}));if(!n)return;const s=je.parse(n);s&&(t.currentTarget===this.blurInput&&s.amount<0&&(s.amount=0),i.value=s.asCSSText(),i.selectionStart=0,i.selectionEnd=i.value.length,this.onTextInput(t),t.consume(!0))}onTextInput(e){const t=e.currentTarget;this.changedElement=t,this.changedElement.classList.remove("invalid");const i=je.parse(t.value);!i||t===this.blurInput&&i.amount<0||(t===this.xInput?(this.model.setOffsetX(i),this.updateCanvas(!1)):t===this.yInput?(this.model.setOffsetY(i),this.updateCanvas(!1)):t===this.blurInput?(this.model.setBlurRadius(i),this.blurSlider.value=i.amount.toString()):t===this.spreadInput&&(this.model.setSpreadRadius(i),this.spreadSlider.value=i.amount.toString()),this.dispatchEventToListeners("ShadowChanged",this.model))}onTextBlur(){if(!this.changedElement)return;let e=this.changedElement.value.trim()?je.parse(this.changedElement.value):je.zero();if(e||(e=je.parse(this.changedElement.value+Ne)),!e)return this.changedElement.classList.add("invalid"),void(this.changedElement=null);this.changedElement===this.xInput?(this.model.setOffsetX(e),this.xInput.value=e.asCSSText(),this.updateCanvas(!1)):this.changedElement===this.yInput?(this.model.setOffsetY(e),this.yInput.value=e.asCSSText(),this.updateCanvas(!1)):this.changedElement===this.blurInput?(e.amount<0&&(e=je.zero()),this.model.setBlurRadius(e),this.blurInput.value=e.asCSSText(),this.blurSlider.value=e.amount.toString()):this.changedElement===this.spreadInput&&(this.model.setSpreadRadius(e),this.spreadInput.value=e.asCSSText(),this.spreadSlider.value=e.amount.toString()),this.changedElement=null,this.dispatchEventToListeners("ShadowChanged",this.model)}onSliderInput(e){e.currentTarget===this.blurSlider?(this.model.setBlurRadius(new je(Number(this.blurSlider.value),this.model.blurRadius().unit||Ne)),this.blurInput.value=this.model.blurRadius().asCSSText(),this.blurInput.classList.remove("invalid")):e.currentTarget===this.spreadSlider&&(this.model.setSpreadRadius(new je(Number(this.spreadSlider.value),this.model.spreadRadius().unit||Ne)),this.spreadInput.value=this.model.spreadRadius().asCSSText(),this.spreadInput.classList.remove("invalid")),this.dispatchEventToListeners("ShadowChanged",this.model)}dragStart(t){this.xySlider.focus(),this.updateCanvas(!0),this.canvasOrigin=new e.Geometry.Point(this.xySlider.getBoundingClientRect().left+this.halfCanvasSize,this.xySlider.getBoundingClientRect().top+this.halfCanvasSize);const i=new e.Geometry.Point(t.x-this.canvasOrigin.x,t.y-this.canvasOrigin.y),n=this.sliderThumbPosition();return i.distanceTo(n)>=6&&this.dragMove(t),!0}dragMove(t){let i=new e.Geometry.Point(t.x-this.canvasOrigin.x,t.y-this.canvasOrigin.y);t.shiftKey&&(i=this.snapToClosestDirection(i));const n=this.constrainPoint(i,this.innerCanvasSize),s=Math.round(n.x/this.innerCanvasSize*De),o=Math.round(n.y/this.innerCanvasSize*De);t.shiftKey?(this.model.setOffsetX(new je(s,this.model.offsetX().unit||Ne)),this.model.setOffsetY(new je(o,this.model.offsetY().unit||Ne))):(t.altKey||this.model.setOffsetX(new je(s,this.model.offsetX().unit||Ne)),e.KeyboardShortcut.KeyboardShortcut.eventHasCtrlEquivalentKey(t)||this.model.setOffsetY(new je(o,this.model.offsetY().unit||Ne))),this.xInput.value=this.model.offsetX().asCSSText(),this.yInput.value=this.model.offsetY().asCSSText(),this.xInput.classList.remove("invalid"),this.yInput.classList.remove("invalid"),this.updateCanvas(!0),this.dispatchEventToListeners("ShadowChanged",this.model)}onCanvasBlur(){this.updateCanvas(!1)}onCanvasArrowKey(e){const t=e;let n=0,s=0;if("ArrowRight"===t.key?n=1:"ArrowLeft"===t.key?n=-1:"ArrowUp"===t.key?s=-1:"ArrowDown"===t.key&&(s=1),n||s){if(e.consume(!0),n){const e=this.model.offsetX(),t=i.NumberUtilities.clamp(e.amount+n,-20,De);if(t===e.amount)return;this.model.setOffsetX(new je(t,e.unit||Ne)),this.xInput.value=this.model.offsetX().asCSSText(),this.xInput.classList.remove("invalid")}if(s){const e=this.model.offsetY(),t=i.NumberUtilities.clamp(e.amount+s,-20,De);if(t===e.amount)return;this.model.setOffsetY(new je(t,e.unit||Ne)),this.yInput.value=this.model.offsetY().asCSSText(),this.yInput.classList.remove("invalid")}this.updateCanvas(!0),this.dispatchEventToListeners("ShadowChanged",this.model)}}constrainPoint(t,i){return Math.abs(t.x)<=i&&Math.abs(t.y)<=i?new e.Geometry.Point(t.x,t.y):t.scale(i/Math.max(Math.abs(t.x),Math.abs(t.y)))}snapToClosestDirection(t){let i=Number.MAX_VALUE,n=t;const s=[new e.Geometry.Point(0,-1),new e.Geometry.Point(1,-1),new e.Geometry.Point(1,0),new e.Geometry.Point(1,1)];for(const e of s){const s=t.projectOn(e),o=t.distanceTo(s);o<i&&(i=o,n=s)}return n}sliderThumbPosition(){const t=this.model.offsetX().amount/De*this.innerCanvasSize,i=this.model.offsetY().amount/De*this.innerCanvasSize;return this.constrainPoint(new e.Geometry.Point(t,i),this.innerCanvasSize)}}var Ve=Object.freeze({__proto__:null,CSSLength:je,CSSShadowEditor:He}),Ge={cssText:`:host{user-select:none;padding:4px 12px 12px}.error-input{box-shadow:0 0 0 1px var(--sys-color-error)}.error-text{color:var(--sys-color-error);padding:6px 0}.warning-input{--override-warning-input-color:#ffdd9e;box-shadow:0 0 0 1px var(--override-warning-input-color)}.theme-with-dark-background .warning-input,\n:host-context(.theme-with-dark-background) .warning-input{--override-warning-input-color:rgb(97 63 0)}.hide-warning{display:none}.font-section-header{font-weight:normal;font-size:17px;text-align:left}.font-section-subheader{font-size:12px;text-align:left;font-weight:bold}.font-selector-section{overflow-y:auto;padding-bottom:10px}.font-selector-input{width:204px;text-align-last:center}.font-reset-button{width:100%;margin-top:10px}.font-section{border-top:1px solid var(--sys-color-divider)}select.font-editor-select{min-width:50px;min-height:27px}input::-webkit-outer-spin-button,\ninput::-webkit-inner-spin-button{display:none;margin:0}.preview-text{max-width:300px;word-break:normal;overflow-wrap:anywhere;display:block}.rendered-font-list-label{font-weight:bold;font-size:12px}.rendered-font-list{padding:5px 0}.shadow-editor-field{height:24px;margin-top:8px;font-size:12px;flex-shrink:0}.shadow-editor-field:last-of-type{margin-bottom:8px}.shadow-editor-flex-field{display:flex;align-items:center;flex-direction:row}.shadow-editor-field.shadow-editor-blur-field{margin-top:40px}.shadow-editor-2D-slider{position:absolute;height:88px;width:88px;border:1px solid var(--divider-line);border-radius:2px}.shadow-editor-label{display:inline-block;width:70px;height:24px;line-height:24px;margin-right:8px;text-align:left}.shadow-editor-button-left,\n.shadow-editor-button-right{width:74px;height:24px;padding:3px 7px;line-height:16px;border:1px solid var(--divider-line);color:var(--sys-color-on-surface);background-color:var(--sys-color-cdt-base-container);text-align:center;font-weight:500}.shadow-editor-button-left{border-radius:2px 0 0 2px}.shadow-editor-button-right{border-radius:0 2px 2px 0;border-left-width:0}.shadow-editor-button-left:hover,\n.shadow-editor-button-right:hover{box-shadow:0 1px 1px var(--divider-line)}.shadow-editor-button-left:focus,\n.shadow-editor-button-right:focus{background-color:var(--sys-color-state-focus-highlight)}.shadow-editor-text-input{width:50px;margin:8px;text-align:center;box-shadow:var(--legacy-focus-ring-inactive-shadow)}.spectrum-switcher{border-radius:2px;height:20px;width:20px;padding:2px;margin-left:5px}.spectrum-switcher:hover{background-color:var(--sys-color-state-hover-on-subtle)}.spectrum-switcher:focus-visible{background-color:var(--sys-color-state-focus-highlight)}\n/*# sourceURL=${import.meta.resolve("./fontEditor.css")} */\n`};async function Ke(t){const i=e.Context.Context.instance().flavor(h.DOMModel.DOMNode);let n;if(i?.parentNode&&"HTML"!==i.nodeName()){const[e]=h.TargetManager.TargetManager.instance().models(u.CSSOverviewModel.CSSOverviewModel),s=t?i.parentNode.id:i.id,o=(await e.getComputedStyleForNode(s).then(We)).replace(/[a-z]/g,"");n=parseFloat(o)}else n=16;return n}function We(e){const t=e.computedStyle;let i=6;if(t[i].name&&"font-size"!==t[i].name)for(let e=0;e<t.length;e++)if("font-size"===t[e].name){i=e;break}return t[i].value}const Xe={expression:"window.innerWidth",includeCommandLineAPI:!1,silent:!0,returnByValue:!1,generatePreview:!1,userGesture:!1,awaitPromise:!0,throwOnSideEffect:!1,disableBreaks:!0,replMode:!1,allowUnsafeEvalBlockedByCSP:!1},Ye={expression:"window.innerHeight",includeCommandLineAPI:!1,silent:!0,returnByValue:!1,generatePreview:!1,userGesture:!1,awaitPromise:!0,throwOnSideEffect:!1,disableBreaks:!0,replMode:!1,allowUnsafeEvalBlockedByCSP:!1};async function qe(){const t=e.Context.Context.instance().flavor(h.RuntimeModel.ExecutionContext);let i,n;if(t){const e=await t.evaluate(Xe,!1,!1),s=await t.evaluate(Ye,!1,!1);if("error"in e||"error"in s)return null;e.object&&(i=e.object.value),s.object&&(n=s.object.value)}if(void 0===i||void 0===n){const t=e.Context.Context.instance().flavor(h.DOMModel.DOMNode);if(!t)return null;const s=await t.domModel().target().pageAgent().invoke_getLayoutMetrics(),o=s.visualViewport.zoom?s.visualViewport.zoom:1;n=s.visualViewport.clientHeight/o,i=s.visualViewport.clientWidth/o}return{width:i,height:n}}const Ze=new Map;async function Qe(e,t,i){let n,s;""===e&&(e="em"),""===t&&(t="em");const o=Ze.get(e),r=Ze.get(t);return o&&r?(n="em"===e||"%"===e?await o(i):await o(),s="em"===t||"%"===t?await r(i):await r(),n/s):1}Ze.set("px",(function(){return 1})),Ze.set("em",Ke),Ze.set("rem",(async function(){const t=function(e){let t=e;for(;t&&"HTML"!==t.nodeName()&&t.parentNode;)t=t.parentNode;return t}(e.Context.Context.instance().flavor(h.DOMModel.DOMNode));if(!t||!t.id)return 16;const[i]=h.TargetManager.TargetManager.instance().models(u.CSSOverviewModel.CSSOverviewModel),n=(await i.getComputedStyleForNode(t.id).then(We)).replace(/[a-z]/g,"");return parseFloat(n)})),Ze.set("%",(async function(e){return await Ke(e)/100})),Ze.set("vh",(async function(){const e=await qe();return e?e.height/100:1})),Ze.set("vw",(async function(){const e=await qe();return e?e.width/100:1})),Ze.set("vmin",(async function(){const e=await qe();if(!e)return 1;const t=e.width,i=e.height;return Math.min(t,i)/100})),Ze.set("vmax",(async function(){const e=await qe();if(!e)return 1;const t=e.width,i=e.height;return Math.max(t,i)/100})),Ze.set("cm",(function(){return 37.795})),Ze.set("mm",(function(){return 3.7795})),Ze.set("in",(function(){return 96})),Ze.set("pt",(function(){return 4/3})),Ze.set("pc",(function(){return 16}));var Je=Object.freeze({__proto__:null,getUnitConversionMultiplier:Qe});const et=new Set(["px","em","rem","%","vh","vw"]),tt=new Set(["","px","em","%"]),it=new Set(["em","rem","px"]),nt=["","xx-small","x-small","smaller","small","medium","large","larger","x-large","xx-large"],st=["","normal"],ot=["","lighter","normal","bold","bolder"],rt=["","normal"],at=["inherit","initial","unset"];nt.push(...at),st.push(...at),ot.push(...at),rt.push(...at);const lt=new Set(nt),dt=new Set(st),ht=new Set(ot),ct=new Set(rt),ut=new Map([["px",{min:0,max:72,step:1}],["em",{min:0,max:4.5,step:.1}],["rem",{min:0,max:4.5,step:.1}],["%",{min:0,max:450,step:1}],["vh",{min:0,max:10,step:.1}],["vw",{min:0,max:10,step:.1}],["vmin",{min:0,max:10,step:.1}],["vmax",{min:0,max:10,step:.1}],["cm",{min:0,max:2,step:.1}],["mm",{min:0,max:20,step:.1}],["in",{min:0,max:1,step:.01}],["pt",{min:0,max:54,step:1}],["pc",{min:0,max:4.5,step:.1}]]),pt=new Map([["",{min:0,max:2,step:.1}],["em",{min:0,max:2,step:.1}],["%",{min:0,max:200,step:1}],["px",{min:0,max:32,step:1}],["rem",{min:0,max:2,step:.1}],["vh",{min:0,max:4.5,step:.1}],["vw",{min:0,max:4.5,step:.1}],["vmin",{min:0,max:4.5,step:.1}],["vmax",{min:0,max:4.5,step:.1}],["cm",{min:0,max:1,step:.1}],["mm",{min:0,max:8.5,step:.1}],["in",{min:0,max:.5,step:.1}],["pt",{min:0,max:24,step:1}],["pc",{min:0,max:2,step:.1}]]),mt=new Map([["",{min:100,max:700,step:100}]]),gt=new Map([["px",{min:-10,max:10,step:.01}],["em",{min:-.625,max:.625,step:.001}],["rem",{min:-.625,max:.625,step:.001}],["%",{min:-62.5,max:62.5,step:.1}],["vh",{min:-1.5,max:1.5,step:.01}],["vw",{min:-1.5,max:1.5,step:.01}],["vmin",{min:-1.5,max:1.5,step:.01}],["vmax",{min:-1.5,max:1.5,step:.01}],["cm",{min:-.25,max:.025,step:.001}],["mm",{min:-2.5,max:2.5,step:.01}],["in",{min:-.1,max:.1,step:.001}],["pt",{min:-7.5,max:7.5,step:.01}],["pc",{min:-.625,max:.625,step:.001}]]),vt={regex:/(^[\+\d\.]+)([a-zA-Z%]+)/,units:et,keyValues:lt,rangeMap:ut,defaultUnit:"px"},xt={regex:/(^[\+\d\.]+)([a-zA-Z%]*)/,units:tt,keyValues:dt,rangeMap:pt,defaultUnit:""},bt={regex:/(^[\+\d\.]+)/,units:null,keyValues:ht,rangeMap:mt,defaultUnit:null},ft={regex:/([\+-0-9\.]+)([a-zA-Z%]+)/,units:it,keyValues:ct,rangeMap:gt,defaultUnit:"em"},wt=["Arial","Bookman","Candara","Comic Sans MS","Courier New","Garamond","Georgia","Helvetica","Impact","Palatino","Roboto","Times New Roman","Verdana"],yt=["serif","sans-serif","monspace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","emoji","math","fangsong"];async function St(){const e=h.TargetManager.TargetManager.instance().models(u.CSSOverviewModel.CSSOverviewModel);if(e){const t=e[0];if(t){const{fontInfo:e}=await t.getNodeStyleStats();return Array.from(e.keys())}}return[]}function Ct(e){switch(e){case 1:default:return 0;case.1:return 1;case.01:return 2;case.001:return 3}}var It=Object.freeze({__proto__:null,FontSizeStaticParams:vt,FontWeightStaticParams:bt,GenericFonts:yt,GlobalValues:at,LetterSpacingStaticParams:ft,LineHeightStaticParams:xt,SystemFonts:wt,generateComputedFontArray:St,getRoundingPrecision:Ct});const kt={fontFamily:"Font Family",cssProperties:"CSS Properties",fontSize:"Font Size",lineHeight:"Line Height",fontWeight:"Font Weight",spacing:"Spacing",fallbackS:"Fallback {PH1}",thereIsNoValueToDeleteAtIndexS:"There is no value to delete at index: {PH1}",fontSelectorDeletedAtIndexS:"Font Selector deleted at index: {PH1}",deleteS:"Delete {PH1}",PleaseEnterAValidValueForSText:"* Please enter a valid value for {PH1} text input",thisPropertyIsSetToContainUnits:"This property is set to contain units but does not have a defined corresponding unitsArray: {PH1}",sSliderInput:"{PH1} Slider Input",sTextInput:"{PH1} Text Input",units:"Units",sUnitInput:"{PH1} Unit Input",sKeyValueSelector:"{PH1} Key Value Selector",sToggleInputType:"{PH1} toggle input type",selectorInputMode:"Selector Input Mode",sliderInputMode:"Slider Input Mode"},Et=l.i18n.registerUIStrings("ui/legacy/components/inline_editor/FontEditor.ts",kt),Pt=l.i18n.getLocalizedString.bind(void 0,Et);class Tt extends(s.ObjectWrapper.eventMixin(e.Widget.VBox)){selectedNode;propertyMap;fontSelectorSection;fontSelectors;fontsList;constructor(t){super(!0),this.registerRequiredCSS(Ge),this.selectedNode=e.Context.Context.instance().flavor(h.DOMModel.DOMNode),this.propertyMap=t,this.contentElement.tabIndex=0,this.contentElement.setAttribute("jslog",`${n.dialog("font-editor").parent("mapped").track({keydown:"Enter|Escape"})}`),this.setDefaultFocusedElement(this.contentElement),this.fontSelectorSection=this.contentElement.createChild("div","font-selector-section"),this.fontSelectorSection.createChild("h2","font-section-header").textContent=Pt(kt.fontFamily),this.fontSelectors=[],this.fontsList=null;const i=this.propertyMap.get("font-family");this.createFontSelectorSection(i);const s=this.contentElement.createChild("div","font-section");s.createChild("h2","font-section-header").textContent=Pt(kt.cssProperties);const o=this.getPropertyInfo("font-size",vt.regex),r=this.getPropertyInfo("line-height",xt.regex),a=this.getPropertyInfo("font-weight",bt.regex),l=this.getPropertyInfo("letter-spacing",ft.regex);new zt("font-size",Pt(kt.fontSize),s,o,vt,this.updatePropertyValue.bind(this),this.resizePopout.bind(this),!0),new zt("line-height",Pt(kt.lineHeight),s,r,xt,this.updatePropertyValue.bind(this),this.resizePopout.bind(this),!0),new zt("font-weight",Pt(kt.fontWeight),s,a,bt,this.updatePropertyValue.bind(this),this.resizePopout.bind(this),!1),new zt("letter-spacing",Pt(kt.spacing),s,l,ft,this.updatePropertyValue.bind(this),this.resizePopout.bind(this),!0)}async createFontSelectorSection(e){if(e){const t=e.split(",");if(await this.createFontSelector(t[0],!0),!at.includes(t[0]))for(let e=1;e<t.length+1;e++)this.createFontSelector(t[e])}else this.createFontSelector("",!0);this.resizePopout()}async createFontsList(){const e=await St(),t=new Map,i=this.splitComputedFontArray(e);t.set("Computed Fonts",i);const n=new Map;n.set("System Fonts",wt),n.set("Generic Families",yt);const s=[];return s.push(t),s.push(n),s}splitComputedFontArray(e){const t=[];for(const i of e)if(i.includes(",")){i.split(",").forEach((e=>{-1===t.findIndex((t=>t.toLowerCase()===e.trim().toLowerCase().replace(/"/g,"'")))&&t.push(e.trim().replace(/"/g,""))}))}else-1===t.findIndex((e=>e.toLowerCase()===i.toLowerCase().replace('"',"'")))&&t.push(i.replace(/"/g,""));return t}async createFontSelector(e,t){if(e=e?e.trim():""){const t=e.charAt(0);"'"===t?e=e.replace(/'/g,""):'"'===t&&(e=e.replace(/"/g,""))}const i=this.fontSelectorSection.createChild("div","shadow-editor-field shadow-editor-flex-field");let n;if(this.fontsList||(this.fontsList=await this.createFontsList()),t){n=Pt(kt.fontFamily);const t=new Map([["Global Values",at]]),s=[...this.fontsList];s.push(t),this.createSelector(i,n,s,e.trim(),"primary-font-family")}else n=Pt(kt.fallbackS,{PH1:this.fontSelectors.length}),this.createSelector(i,n,this.fontsList,e.trim(),"fallback-font-family")}deleteFontSelector(t,i){let n=this.fontSelectors[t];const s=0===t;if(""===n.input.value&&!i)return void e.ARIAUtils.alert(Pt(kt.thereIsNoValueToDeleteAtIndexS,{PH1:t}));if(s){const e=this.fontSelectors[1];let i="";e&&(i=e.input.value,n=e);this.fontSelectors[0].input.value=i,t=1}if(n.input.parentNode){const i=this.fontSelectors.length>1;if(!s||i){const e=n.input.parentElement;e&&(e.remove(),this.fontSelectors.splice(t,1),this.updateFontSelectorList())}e.ARIAUtils.alert(Pt(kt.fontSelectorDeletedAtIndexS,{PH1:t}))}this.onFontSelectorChanged(),this.resizePopout();const o=s?0:t-1;this.fontSelectors[o].input.focus()}updateFontSelectorList(){for(let t=0;t<this.fontSelectors.length;t++){const i=this.fontSelectors[t];let n;n=0===t?Pt(kt.fontFamily):Pt(kt.fallbackS,{PH1:t}),i.label.textContent=n,e.ARIAUtils.setLabel(i.input,n),i.deleteButton.setTitle(Pt(kt.deleteS,{PH1:n})),i.index=t}}getPropertyInfo(e,t){const i=this.propertyMap.get(e);if(i){const e=i,n=e.match(t);if(n){return{value:"+"===n[1].charAt(0)?n[1].substr(1):n[1],units:n[2]?n[2]:""}}return{value:e,units:null}}return{value:null,units:null}}createSelector(t,s,o,r,a){const l=this.fontSelectors.length,d=e.UIUtils.createSelect(s,o);d.value=r,d.setAttribute("jslog",`${n.dropDown(a).track({click:!0,change:!0})}`);const h=e.UIUtils.createLabel(s,"shadow-editor-label",d);d.addEventListener("input",this.onFontSelectorChanged.bind(this),!1),d.addEventListener("keydown",(e=>{"Enter"===e.key&&e.consume()}),!1),t.appendChild(h),t.appendChild(d);const c=t.createChild("devtools-toolbar"),u=new e.Toolbar.ToolbarButton(Pt(kt.deleteS,{PH1:s}),"bin",void 0,"delete");c.appendToolbarItem(u);const p={label:h,input:d,deleteButton:u,index:l};u.addEventListener("Click",(()=>{this.deleteFontSelector(p.index)})),u.element.addEventListener("keydown",(e=>{i.KeyboardUtilities.isEnterOrSpaceKey(e)&&(this.deleteFontSelector(p.index),e.consume())}),!1),this.fontSelectors.push(p)}onFontSelectorChanged(){let e="";const t=at.includes(this.fontSelectors[0].input.value);if(t)for(let e=1;e<this.fontSelectors.length;e++)this.deleteFontSelector(e,!0);for(const t of this.fontSelectors){const i=t.input;""!==i.value&&(""===e?e=this.fontSelectors[0].input.value:e+=", "+i.value)}""!==this.fontSelectors[this.fontSelectors.length-1].input.value&&!t&&this.fontSelectors.length<10&&(this.createFontSelector(""),this.resizePopout()),this.updatePropertyValue("font-family",e)}updatePropertyValue(e,t){this.dispatchEventToListeners("FontChanged",{propertyName:e,value:t})}resizePopout(){this.dispatchEventToListeners("FontEditorResized")}}class zt{showSliderMode;errorText;propertyInfo;propertyName;staticParams;hasUnits;units;addedUnit;initialRange;boundUpdateCallback;boundResizeCallback;selectedNode;sliderInput;textBoxInput;unitInput;selectorInput;applyNextInput;constructor(t,i,n,s,o,r,a,l){this.showSliderMode=!0;const d=n.createChild("div","shadow-editor-field shadow-editor-flex-field");if(this.errorText=n.createChild("div","error-text"),this.errorText.textContent=Pt(kt.PleaseEnterAValidValueForSText,{PH1:t}),this.errorText.hidden=!0,e.ARIAUtils.markAsAlert(this.errorText),this.propertyInfo=s,this.propertyName=t,this.staticParams=o,this.hasUnits=l,this.hasUnits&&this.staticParams.units&&null!==this.staticParams.defaultUnit){const e=this.staticParams.defaultUnit;this.units=null!==s.units?s.units:e,this.addedUnit=!this.staticParams.units.has(this.units)}else{if(this.hasUnits)throw new Error(Pt(kt.thisPropertyIsSetToContainUnits,{PH1:t}));this.units=""}this.initialRange=this.getUnitRange(),this.boundUpdateCallback=r,this.boundResizeCallback=a,this.selectedNode=e.Context.Context.instance().flavor(h.DOMModel.DOMNode);const c=e.UIUtils.createLabel(i,"shadow-editor-label");d.append(c),this.sliderInput=this.createSliderInput(d,t),this.textBoxInput=this.createTextBoxInput(d,t),e.ARIAUtils.bindLabelToControl(c,this.textBoxInput),this.unitInput=this.createUnitInput(d,`${t}-unit`),this.selectorInput=this.createSelectorInput(d,t),this.createTypeToggle(d,`${t}-value-type`),this.checkSelectorValueAndToggle(),this.applyNextInput=!1}setInvalidTextBoxInput(e){e?this.errorText.hidden&&(this.errorText.hidden=!1,this.textBoxInput.classList.add("error-input"),this.boundResizeCallback()):this.errorText.hidden||(this.errorText.hidden=!0,this.textBoxInput.classList.remove("error-input"),this.boundResizeCallback())}checkSelectorValueAndToggle(){return!(!this.staticParams.keyValues||null===this.propertyInfo.value||!this.staticParams.keyValues.has(this.propertyInfo.value))&&(this.toggleInputType(),!0)}getUnitRange(){let e=0,t=100,i=1;if(null!==this.propertyInfo.value&&/\d/.test(this.propertyInfo.value))if(this.staticParams.rangeMap.get(this.units)){const n=this.staticParams.rangeMap.get(this.units);n&&(e=Math.min(n.min,parseFloat(this.propertyInfo.value)),t=Math.max(n.max,parseFloat(this.propertyInfo.value)),i=n.step)}else{const n=this.staticParams.rangeMap.get("px");n&&(e=Math.min(n.min,parseFloat(this.propertyInfo.value)),t=Math.max(n.max,parseFloat(this.propertyInfo.value)),i=n.step)}else{const n=this.staticParams.rangeMap.get(this.units);n&&(e=n.min,t=n.max,i=n.step)}return{min:e,max:t,step:i}}createSliderInput(t,i){const s=this.initialRange.min,o=this.initialRange.max,r=this.initialRange.step,a=e.UIUtils.createSlider(s,o,-1);if(a.step=r.toString(),a.tabIndex=0,this.propertyInfo.value)a.value=this.propertyInfo.value;else{const e=(s+o)/2;a.value=e.toString()}return a.addEventListener("input",(e=>{this.onSliderInput(e,!1)})),a.addEventListener("mouseup",(e=>{this.onSliderInput(e,!0)})),a.addEventListener("keydown",(e=>{"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||(this.applyNextInput=!0)})),t.appendChild(a),e.ARIAUtils.setLabel(a,Pt(kt.sSliderInput,{PH1:this.propertyName})),a.setAttribute("jslog",`${n.slider(i).track({change:!0})}`),a}createTextBoxInput(t,i){const n=e.UIUtils.createInput("shadow-editor-text-input","number",i);return n.step=this.initialRange.step.toString(),n.classList.add("font-editor-text-input"),null!==this.propertyInfo.value&&("+"===this.propertyInfo.value.charAt(0)&&(this.propertyInfo.value=this.propertyInfo.value.substr(1)),n.value=this.propertyInfo.value),n.step="any",n.addEventListener("input",this.onTextBoxInput.bind(this),!1),t.appendChild(n),e.ARIAUtils.setLabel(n,Pt(kt.sTextInput,{PH1:this.propertyName})),n}createUnitInput(t,i){let s;if(this.hasUnits&&this.staticParams.units){const t=this.propertyInfo.units,i=this.staticParams.units;s=e.UIUtils.createSelect(Pt(kt.units),i),s.classList.add("font-editor-select"),this.addedUnit&&t&&s.add(new Option(t,t)),t&&(s.value=t),s.addEventListener("change",this.onUnitInput.bind(this),!1)}else s=e.UIUtils.createSelect(Pt(kt.units),[]),s.classList.add("font-editor-select"),s.disabled=!0;return s.setAttribute("jslog",`${n.dropDown(i).track({click:!0,change:!0})}`),s.addEventListener("keydown",(e=>{"Enter"===e.key&&e.consume()}),!1),t.appendChild(s),e.ARIAUtils.setLabel(s,Pt(kt.sUnitInput,{PH1:this.propertyName})),s}createSelectorInput(t,i){const s=e.UIUtils.createSelect(Pt(kt.sKeyValueSelector,{PH1:this.propertyName}),this.staticParams.keyValues);return s.classList.add("font-selector-input"),this.propertyInfo.value&&(s.value=this.propertyInfo.value),s.addEventListener("input",this.onSelectorInput.bind(this),!1),s.addEventListener("keydown",(e=>{"Enter"===e.key&&e.consume()}),!1),t.appendChild(s),s.hidden=!0,s.setAttribute("jslog",`${n.dropDown(i).track({click:!0,change:!0})}`),s}onSelectorInput(e){if(e.currentTarget){const t=e.currentTarget.value;this.textBoxInput.value="";const i=(parseFloat(this.sliderInput.min)+parseFloat(this.sliderInput.max))/2;this.sliderInput.value=i.toString(),this.setInvalidTextBoxInput(!1),this.boundUpdateCallback(this.propertyName,t)}}onSliderInput(e,t){const i=e.currentTarget;if(i){const e=i.value;this.textBoxInput.value=e,this.selectorInput.value="";const n=this.hasUnits?e+this.unitInput.value:e.toString();this.setInvalidTextBoxInput(!1),(t||this.applyNextInput)&&(this.boundUpdateCallback(this.propertyName,n),this.applyNextInput=!1)}}onTextBoxInput(e){const t=e.currentTarget;if(t){const e=t.value,i=e+(""===e?"":this.unitInput.value);this.staticParams.regex.test(i)||""===e&&!t.validationMessage.length?(parseFloat(e)>parseFloat(this.sliderInput.max)?this.sliderInput.max=e:parseFloat(e)<parseFloat(this.sliderInput.min)&&(this.sliderInput.min=e),this.sliderInput.value=e,this.selectorInput.value="",this.setInvalidTextBoxInput(!1),this.boundUpdateCallback(this.propertyName,i)):this.setInvalidTextBoxInput(!0)}}async onUnitInput(e){const t=e.currentTarget,i=t.hasFocus(),n=t.value;t.disabled=!0;const s=this.units,o=await Qe(s,n,"font-size"===this.propertyName);this.setInputUnits(o,n),this.textBoxInput.value&&this.boundUpdateCallback(this.propertyName,this.textBoxInput.value+n),this.units=n,t.disabled=!1,i&&t.focus()}createTypeToggle(t,i){const s=t.createChild("div","spectrum-switcher"),o=new c.Icon.Icon;o.data={iconName:"fold-more",color:"var(--icon-default)",width:"16px",height:"16px"},s.appendChild(o),e.UIUtils.setTitle(s,Pt(kt.sToggleInputType,{PH1:this.propertyName})),s.tabIndex=0,self.onInvokeElement(s,this.toggleInputType.bind(this)),e.ARIAUtils.markAsButton(s),s.setAttribute("jslog",`${n.toggle(i).track({click:!0})}`)}toggleInputType(t){t&&"Enter"===t.key&&t.consume(),this.showSliderMode?(this.sliderInput.hidden=!0,this.textBoxInput.hidden=!0,this.unitInput.hidden=!0,this.selectorInput.hidden=!1,this.showSliderMode=!1,e.ARIAUtils.alert(Pt(kt.selectorInputMode))):(this.sliderInput.hidden=!1,this.textBoxInput.hidden=!1,this.unitInput.hidden=!1,this.selectorInput.hidden=!0,this.showSliderMode=!0,e.ARIAUtils.alert(Pt(kt.sliderInputMode)))}setInputUnits(e,t){const i=this.staticParams.rangeMap.get(t);let n,s,o;i?(n=i.min,s=i.max,o=i.step):(n=0,s=100,o=1);let r=!1;const a=Ct(o);let l=(n+s)/2;this.textBoxInput.value&&(r=!0,l=parseFloat((parseFloat(this.textBoxInput.value)*e).toFixed(a))),this.sliderInput.min=Math.min(l,n).toString(),this.sliderInput.max=Math.max(l,s).toString(),this.sliderInput.step=o.toString(),this.textBoxInput.step=o.toString(),r&&(this.textBoxInput.value=l.toString()),this.sliderInput.value=l.toString()}}var Mt=Object.freeze({__proto__:null,FontEditor:Tt}),At=`.link-swatch-link{display:inline}.link-swatch-link:not(.undefined){cursor:pointer;text-underline-offset:2px;color:var(--text-link)}.link-swatch-link:hover:not(.undefined){text-decoration:underline}.link-swatch-link:focus:not(:focus-visible){outline:none}.link-swatch-link.undefined{opacity:100%;color:var(--text-disabled)}\n/*# sourceURL=${import.meta.resolve("./linkSwatch.css")} */\n`;const{render:Ut,html:Lt,nothing:Ft,Directives:{ref:Bt,ifDefined:Rt,classMap:Ot}}=o;class $t extends HTMLElement{onLinkActivate=()=>{};#L;connectedCallback(){}set data(e){this.onLinkActivate=(t,n)=>{n instanceof MouseEvent&&0!==n.button||n instanceof KeyboardEvent&&n.key!==i.KeyboardUtilities.ENTER_KEY&&" "!==n.key||(e.onLinkActivate(t),n.consume(!0))},this.render(e)}get linkElement(){return this.#L}render(e){const{isDefined:t,text:i,jslogContext:s,tooltip:o}=e,r=Ot({"link-style":!0,"text-button":!0,"link-swatch-link":!0,undefined:!t}),a=t?this.onLinkActivate.bind(this,i.trim()):null,l=o&&"title"in o&&o.title||void 0,d=o&&"tooltipId"in o&&o.tooltipId||void 0;Ut(Lt`<style>${p.textButtonStyles.cssText}</style><style>${At}</style><button
          .disabled=${!t}
          jslog=${s?n.link().track({click:!0}).context(s):Ft}
          class=${r}
          type="button"
          title=${Rt(l)}
          aria-details=${Rt(d)}
          @click=${a}
          @keydown=${a}
          role="link"
          tabindex=${Rt(t?-1:void 0)}
          ${Bt((e=>{this.#L=e}))}
          >${i}</button>`,this)}}customElements.define("devtools-link-swatch",$t);var Dt=Object.freeze({__proto__:null,LinkSwatch:$t}),Nt={cssText:`:host{white-space:nowrap}devtools-icon{position:relative;transform:scale(0.7);margin:-5px -2px -3px -4px;user-select:none;color:var(--icon-css);cursor:default;&:hover{color:var(--icon-css-hover)}}\n/*# sourceURL=${import.meta.resolve("./bezierSwatch.css")} */\n`},_t={cssText:`:host{white-space:nowrap}devtools-icon.shadow-swatch-icon{color:var(--icon-css);transform:scale(0.7);position:relative;margin:-5px -2px -5px -4px;user-select:none;vertical-align:baseline;cursor:pointer;&:hover{color:var(--icon-css-hover)}}\n/*# sourceURL=${import.meta.resolve("./cssShadowSwatch.css")} */\n`};const jt=new CSSStyleSheet;jt.replaceSync(_t.cssText);class Ht extends HTMLElement{#A;#F;constructor(){super();const t=e.UIUtils.createShadowRootWithCoreStyles(this,{cssFile:Nt});this.#A=c.Icon.create("bezier-curve-filled","bezier-swatch-icon"),this.#A.setAttribute("jslog",`${n.showStyleEditor("bezier")}`),t.appendChild(this.#A),this.#F=document.createElement("span"),t.createChild("slot")}static create(){return document.createElement("devtools-bezier-swatch")}bezierText(){return this.#F.textContent||""}setBezierText(e){this.#F.parentElement||this.append(this.#F),this.#F.textContent=e}hideText(e){this.#F.hidden=e}iconElement(){return this.#A}}customElements.define("devtools-bezier-swatch",Ht);class Vt extends HTMLElement{#B=this.attachShadow({mode:"open"});#A;#c;constructor(e){super(),this.#c=e,this.#B.adoptedStyleSheets=[jt],r(a`<devtools-icon name="shadow" class="shadow-swatch-icon"></devtools-icon><slot></slot>`,this.#B,{host:this}),this.#A=this.#B.querySelector("devtools-icon")}model(){return this.#c}iconElement(){return this.#A}}customElements.define("css-shadow-swatch",Vt);var Gt=Object.freeze({__proto__:null,BezierSwatch:Ht,CSSShadowSwatch:Vt}),Kt={cssText:`.widget{display:flex;overflow:auto;user-select:text;font:var(--sys-typescale-body4-regular);line-height:11px;box-shadow:var(--sys-elevation-level2);background-color:var(--sys-color-base-container-elevated);border-radius:var(--sys-shape-corner-extra-small)}.with-padding{padding:var(--sys-size-4);border-radius:var(--sys-shape-corner-small)}\n/*# sourceURL=${import.meta.resolve("./swatchPopover.css")} */\n`};class Wt extends s.ObjectWrapper.ObjectWrapper{popover;hideProxy;boundOnKeyDown;boundFocusOut;isHidden;anchorElement;view;hiddenCallback;focusRestorer;constructor(){super(),this.popover=new e.GlassPane.GlassPane,this.popover.setSizeBehavior("MeasureContent"),this.popover.setMarginBehavior("DefaultMargin"),this.popover.element.addEventListener("mousedown",(e=>e.consume()),!1),this.hideProxy=this.hide.bind(this,!0),this.boundOnKeyDown=this.onKeyDown.bind(this),this.boundFocusOut=this.onFocusOut.bind(this),this.isHidden=!0,this.anchorElement=null}onFocusOut(e){const t=e.relatedTarget;!this.isHidden&&t&&this.view&&!t.isSelfOrDescendant(this.view.contentElement)&&this.hideProxy()}setAnchorElement(e){this.anchorElement=e}isShowing(e){return this.popover.isShowing()&&(e&&this.view===e||!e)}show(e,t,i){if(this.popover.isShowing()){if(this.anchorElement===t)return;this.hide(!0)}n.setMappedParent(e.contentElement,t),this.popover.registerRequiredCSS(Kt),this.dispatchEventToListeners("WillShowPopover"),this.isHidden=!1,this.anchorElement=t,this.view=e,this.hiddenCallback=i,this.reposition(),e.focus();const s=this.popover.element.ownerDocument;s.addEventListener("mousedown",this.hideProxy,!1),s.defaultView&&s.defaultView.addEventListener("resize",this.hideProxy,!1),this.view.contentElement.addEventListener("keydown",this.boundOnKeyDown,!1)}reposition(){if(!this.isHidden&&this.view){if(this.view.contentElement.removeEventListener("focusout",this.boundFocusOut,!1),this.view.show(this.popover.contentElement),this.anchorElement){let e=this.anchorElement.boxInWindow();if(J.isColorSwatch(this.anchorElement)){const t=this.anchorElement;if(!t.anchorBox)return;e=t.anchorBox}this.popover.setContentAnchorBox(e),this.popover.show(this.anchorElement.ownerDocument)}this.view.contentElement.addEventListener("focusout",this.boundFocusOut,!1),this.focusRestorer||(this.focusRestorer=new e.Widget.WidgetFocusRestorer(this.view))}}hide(e){if(this.isHidden)return;const t=this.popover.element.ownerDocument;this.isHidden=!0,this.popover.hide(),t.removeEventListener("mousedown",this.hideProxy,!1),t.defaultView&&t.defaultView.removeEventListener("resize",this.hideProxy,!1),this.hiddenCallback&&this.hiddenCallback.call(null,Boolean(e)),this.focusRestorer&&this.focusRestorer.restore(),this.anchorElement=null,this.view&&(this.view.detach(),this.view.contentElement.removeEventListener("keydown",this.boundOnKeyDown,!1),this.view.contentElement.removeEventListener("focusout",this.boundFocusOut,!1),delete this.view)}onKeyDown(e){if("Enter"===e.key)return this.hide(!0),void e.consume(!0);e.key===i.KeyboardUtilities.ESCAPE_KEY&&(this.hide(!1),e.consume(!0))}}var Xt=Object.freeze({__proto__:null,SwatchPopoverHelper:Wt});export{C as AnimationTimingModel,U as AnimationTimingUI,R as BezierEditor,E as BezierUI,Fe as CSSAngle,ce as CSSAngleUtils,w as CSSLinearEasingModel,Ve as CSSShadowEditor,V as ColorMixSwatch,ee as ColorSwatch,Mt as FontEditor,Je as FontEditorUnitConverter,It as FontEditorUtils,ke as InlineEditorUtils,Dt as LinkSwatch,Xt as SwatchPopoverHelper,Gt as Swatches};
